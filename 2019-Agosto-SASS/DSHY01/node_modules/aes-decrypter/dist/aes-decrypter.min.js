/**
 * aes-decrypter
 * @version 3.0.0
 * @copyright 2017 Brightcove, Inc.
 * @license Apache-2.0
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.aesDecrypter=t.aesDecrypter||{})}(this,function(t){"use strict";function e(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])}var n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],e=t[0],n=t[1],i=e[4],r=n[4],o=void 0,s=void 0,u=void 0,c=[],f=[],l=void 0,a=void 0,h=void 0,p=void 0,y=void 0;for(o=0;o<256;o++)f[(c[o]=o<<1^283*(o>>7))^o]=o;for(s=u=0;!i[s];s^=l||1,u=f[u]||1)for(h=(h=u^u<<1^u<<2^u<<3^u<<4)>>8^255&h^99,i[s]=h,r[h]=s,y=16843009*c[a=c[l=c[s]]]^65537*a^257*l^16843008*s,p=257*c[h]^16843008*h,o=0;o<4;o++)e[o][s]=p=p<<24^p>>>8,n[o][h]=y=y<<24^y>>>8;for(o=0;o<5;o++)e[o]=e[o].slice(0),n[o]=n[o].slice(0);return t},u=null,c=function(){function t(e){n(this,t),u||(u=s()),this._tables=[[u[0][0].slice(),u[0][1].slice(),u[0][2].slice(),u[0][3].slice(),u[0][4].slice()],[u[1][0].slice(),u[1][1].slice(),u[1][2].slice(),u[1][3].slice(),u[1][4].slice()]];var i=void 0,r=void 0,o=void 0,c=void 0,f=void 0,l=this._tables[0][4],a=this._tables[1],h=e.length,p=1;if(4!==h&&6!==h&&8!==h)throw new Error("Invalid aes key size");for(c=e.slice(0),f=[],this._key=[c,f],i=h;i<4*h+28;i++)o=c[i-1],(i%h==0||8===h&&i%h==4)&&(o=l[o>>>24]<<24^l[o>>16&255]<<16^l[o>>8&255]<<8^l[255&o],i%h==0&&(o=o<<8^o>>>24^p<<24,p=p<<1^283*(p>>7))),c[i]=c[i-h]^o;for(r=0;i;r++,i--)o=c[3&r?i:i-4],f[r]=i<=4||r<4?o:a[0][l[o>>>24]]^a[1][l[o>>16&255]]^a[2][l[o>>8&255]]^a[3][l[255&o]]}return t.prototype.decrypt=function(t,e,n,i,r,o){var s=this._key[1],u=t^s[0],c=i^s[1],f=n^s[2],l=e^s[3],a=void 0,h=void 0,p=void 0,y=s.length/4-2,d=void 0,v=4,b=this._tables[1],_=b[0],g=b[1],m=b[2],w=b[3],j=b[4];for(d=0;d<y;d++)a=_[u>>>24]^g[c>>16&255]^m[f>>8&255]^w[255&l]^s[v],h=_[c>>>24]^g[f>>16&255]^m[l>>8&255]^w[255&u]^s[v+1],p=_[f>>>24]^g[l>>16&255]^m[u>>8&255]^w[255&c]^s[v+2],l=_[l>>>24]^g[u>>16&255]^m[c>>8&255]^w[255&f]^s[v+3],v+=4,u=a,c=h,f=p;for(d=0;d<4;d++)r[(3&-d)+o]=j[u>>>24]<<24^j[c>>16&255]<<16^j[f>>8&255]<<8^j[255&l]^s[v++],a=u,u=c,c=f,f=l,l=a},t}(),f=function(){function t(){n(this,t),this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.off=function(t,e){if(!this.listeners[t])return!1;var n=this.listeners[t].indexOf(e);return this.listeners[t].splice(n,1),n>-1},t.prototype.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var n=e.length,i=0;i<n;++i)e[i].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),o=e.length,s=0;s<o;++s)e[s].apply(this,r)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},t}(),l=function(t){function e(){n(this,e);var i=o(this,t.call(this,f));return i.jobs=[],i.delay=1,i.timeout_=null,i}return r(e,t),e.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},e.prototype.push=function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},e}(f);var a=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},h=function(t,e,n){var i=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),r=new c(Array.prototype.slice.call(e)),o=new Uint8Array(t.byteLength),s=new Int32Array(o.buffer),u=void 0,f=void 0,l=void 0,h=void 0,p=void 0,y=void 0,d=void 0,v=void 0,b=void 0;for(u=n[0],f=n[1],l=n[2],h=n[3],b=0;b<i.length;b+=4)p=a(i[b]),y=a(i[b+1]),d=a(i[b+2]),v=a(i[b+3]),r.decrypt(p,y,d,v,s,b),s[b]=a(s[b]^u),s[b+1]=a(s[b+1]^f),s[b+2]=a(s[b+2]^l),s[b+3]=a(s[b+3]^h),u=p,f=y,l=d,h=v;return o},p=function(){function t(i,r,o,s){n(this,t);var u=t.STEP,c=new Int32Array(i.buffer),f=new Uint8Array(i.byteLength),h=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(c.subarray(h,h+u),r,o,f)),h=u;h<c.length;h+=u)o=new Uint32Array([a(c[h-4]),a(c[h-3]),a(c[h-2]),a(c[h-1])]),this.asyncStream_.push(this.decryptChunk_(c.subarray(h,h+u),r,o,f));this.asyncStream_.push(function(){s(null,e(f))})}return t.prototype.decryptChunk_=function(t,e,n,i){return function(){var r=h(t,e,n);i.set(r,t.byteOffset)}},i(t,null,[{key:"STEP",get:function(){return 32e3}}]),t}();t.decrypt=h,t.Decrypter=p,t.AsyncStream=l});